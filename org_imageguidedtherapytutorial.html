<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MITK-IGT: The MITK-IGT Tutorial View</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MITK-IGT
   </div>
   <div id="projectbrief">IGT Extension of MITK</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('org_imageguidedtherapytutorial.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">The MITK-IGT Tutorial View</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This view is not meant as an end-user module. It contains tutorial program code that explains how to use the MITK-IGT component.</p>
<p>It contains only two buttons. The "Start image guided therapy" button will create a virtual tracking device and a virtual tool. It will move the tool around on random paths in a tracking volume of 200x200x200 mm. The tool is visualized with a cone. If you do not see a cone moving around, you will need to initialize the rendering views correctly. Use the DataManager view to perform a global reinit.</p>
<p>The symbol of this view is the following:</p>
<div class="image">
<img src="icon_igt_simple_example.png" alt=""/>
</div>
<p> <br  />
 </p>
<p>and the whole view looks like this:</p>
<div class="image">
<img src="IGTExampleIGT_QT_Tutorial_PluginView.png" alt=""/>
</div>
<p> <br  />
 </p>
<p>In this tutorial we connect to the NDI Polaris tracking system (or alternatively use a virtual tracking device) and we will show the movement of a tool as cone in the StdMultiWidget editor.</p>
<p>First of all, you will have to add an IGT dependency to your cmake list. For this example, MitkIGTUI would be sufficient, but as the plugin contains several views, we have additional OpenIGTLink and US dependencies:</p>
<div class="fragment"><div class="line">project(org_mitk_gui_qt_igtexamples)</div>
<div class="line"> </div>
<div class="line">mitk_create_plugin(</div>
<div class="line">    EXPORT_DIRECTIVE IGTEXAMPLES_EXPORT</div>
<div class="line">    EXPORTED_INCLUDE_SUFFIXES src</div>
<div class="line">    MODULE_DEPENDS MitkQtWidgetsExt MitkIGT MitkIGTUI MitkOpenIGTLink MitkOpenIGTLinkUI MitkUS</div>
<div class="line">)</div>
</div><!-- fragment --><p>When clicking the start button, a cone should move in the 3<a class="el" href="classD.html">D</a> view and stop after clicking the stop button.</p>
<p>The view has several functions. Most of them deal with the basic functionality with the plugin (e.g. CreateQTPartControl or CreateConnections). For a deeper understanding, you might have a look at the files <a class="el" href="QmitkIGTTutorialView_8cpp.html">QmitkIGTTutorialView.cpp</a> and <a class="el" href="QmitkIGTTutorialView_8h.html">QmitkIGTTutorialView.h</a> For our IGT functionality, the following functions are important: </p><ul>
<li>OnStartIGT: Starts the navigation pipeline </li>
<li>OnStopIGT: Disconnect the pipeline </li>
<li>OnTimer: Updates the view</li>
</ul>
<p>Let's now have a deeper look at these functions.</p>
<h1><a class="anchor" id="OnStartIGT"></a>
OnStartIGT</h1>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_slot" href="classQmitkIGTTutorialView.html#a4fa682b14bfb46190e5e49b4534a2f63">QmitkIGTTutorialView::OnStartIGT</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">//This method is called when the &quot;Start Image Guided Therapy&quot; button is pressed. Any kind of navigation application will</span></div>
<div class="line">  <span class="comment">//start with the connection to a tracking system and as we do image guided procedures we want to show</span></div>
<div class="line">  <span class="comment">//something on the screen. In this tutorial we connect to the NDI Polaris tracking system pr a virtual tracking device and we will</span></div>
<div class="line">  <span class="comment">//show the movement of a tool as cone in MITK.</span></div>
<div class="line"> </div>
</div><!-- fragment --><p>We first check in a try environment, if we should use an NDI tracking device or a virtual device. Let's start with NDI, we hardcode the parameters here and give out a warning. In your proper application, the parameters should be set via the gui aswell (see <a class="el" href="org_mitk_views_igttrackingtoolbox.html">The MITK-IGT Tracking Toolbox</a> ), but for simplicity, we just set hardcoded parameters here. If you want to try it with your own NDI device, you need to adapt these parameters here in the code:</p>
<div class="fragment"><div class="line">  <span class="keywordflow">try</span></div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classQmitkIGTTutorialView.html#a770ec28e67ccf5172376efbfc64b1cc1">m_Controls</a>-&gt;m_NDITrackingRadioButton-&gt;isChecked())</div>
<div class="line">    {</div>
<div class="line"><span class="comment">      /**************** Variant 1: Use a NDI Polaris Tracking Device ****************/</span></div>
<div class="line">      <span class="comment">//Here we want to use the NDI Polaris tracking device. Therefore we instantiate a object of the class</span></div>
<div class="line">      <span class="comment">//NDITrackingDevice and make some settings which are necessary for a proper connection to the device.</span></div>
<div class="line">      MITK_INFO &lt;&lt; <span class="stringliteral">&quot;NDI tracking&quot;</span>;</div>
<div class="line">      QMessageBox::warning ( <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;Warning&quot;</span>, <span class="stringliteral">&quot;You have to set the parameters for the NDITracking device inside the code (QmitkIGTTutorialView::OnStartIGT()) before you can use it.&quot;</span>);</div>
<div class="line">      mitk::NDITrackingDevice::Pointer tracker = mitk::NDITrackingDevice::New();  <span class="comment">//instantiate</span></div>
<div class="line">      tracker-&gt;SetPortNumber(<a class="code hl_enumvalue" href="classmitk_1_1SerialCommunication.html#a8b5ad106301af6cc4247826309b2a785a334f5ba616270259a952e53679ecd173">mitk::SerialCommunication::COM4</a>); <span class="comment">//set the comport</span></div>
<div class="line">      tracker-&gt;SetBaudRate(<a class="code hl_enumvalue" href="classmitk_1_1SerialCommunication.html#a1d5c336d9651a87cd9a24de245da75cdae13973fa7f4f4b357c0618ddc7c068ba">mitk::SerialCommunication::BaudRate115200</a>); <span class="comment">//set the baud rate</span></div>
<div class="line">      tracker-&gt;SetType(<a class="code hl_function" href="classmitk_1_1NDIPolarisTypeInformation.html#ab1040a09938daa967f70b181398376cb">mitk::NDIPolarisTypeInformation::GetTrackingDeviceName</a>()); <span class="comment">//set the type there you can choose between Polaris and Aurora</span></div>
<div class="line"> </div>
<div class="line">      <span class="comment">//The tools represent the sensors of the tracking device. In this case we have one pointer tool.</span></div>
<div class="line">      <span class="comment">//The TrackingDevice object it self fills the tool with data. So we have to add the tool to the</span></div>
<div class="line">      <span class="comment">//TrackingDevice object.</span></div>
<div class="line">      <span class="comment">// The Polaris system needs a &quot;.rom&quot; file which describes the geometry of the markers related to the tool tip.</span></div>
<div class="line">      <span class="comment">//NDI provides an own software (NDI architect) to generate those files.</span></div>
<div class="line">      tracker-&gt;AddTool(<span class="stringliteral">&quot;MyInstrument&quot;</span>, <span class="stringliteral">&quot;c:\\myinstrument.rom&quot;</span>);</div>
</div><!-- fragment --><p>The tracking device has to be set to a source. For more information on the tracking pipeline, please have a look at the <a class="el" href="IGTTutorialStepFilterPipeline.html">IGT filter pipeline</a>.</p>
<div class="fragment"><div class="line">      <span class="comment">//The tracking device object is used for the physical connection to the device. To use the</span></div>
<div class="line">      <span class="comment">//data inside of our tracking pipeline we need a source. This source encapsulate the tracking device</span></div>
<div class="line">      <span class="comment">//and provides objects of the type mitk::NavigationData as output. The NavigationData objects stores</span></div>
<div class="line">      <span class="comment">//position, orientation, if the data is valid or not and special error information in a covariance</span></div>
<div class="line">      <span class="comment">//matrix.</span></div>
<div class="line">      <span class="comment">//</span></div>
<div class="line">      <span class="comment">//Typically the start of a pipeline is a TrackingDeviceSource. To work correct we have to set a</span></div>
<div class="line">      <span class="comment">//TrackingDevice object. Attention you have to set the tools before you set the whole TrackingDevice</span></div>
<div class="line">      <span class="comment">//object to the TrackingDeviceSource because the source need to know how many outputs should be</span></div>
<div class="line">      <span class="comment">//generated.</span></div>
<div class="line">      <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a> = mitk::TrackingDeviceSource::New();   <span class="comment">//We need the filter objects to stay alive,</span></div>
<div class="line">      <span class="comment">//therefore they must be members.</span></div>
<div class="line">      <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a>-&gt;SetTrackingDevice(tracker); <span class="comment">//Here we set the tracking device to the source of the pipeline.</span></div>
</div><!-- fragment --><p>Alternatively, we can setup a virtual tracking device. We create this device, set the bounds, add a tool and connect it to the source:</p>
<div class="fragment"><div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line"><span class="comment">      /**************** Variant 2: Emulate a Tracking Device with mitk::VirtualTrackingDevice ****************/</span></div>
<div class="line">      <span class="comment">// For tests, it is useful to simulate a tracking device in software. This is what mitk::VirtualTrackingDevice does.</span></div>
<div class="line">      <span class="comment">// It will produce random position, orientation and error values for each tool that is added.</span></div>
<div class="line">      MITK_INFO &lt;&lt; <span class="stringliteral">&quot;virtual tracking&quot;</span>&lt;&lt;endl;</div>
<div class="line">      mitk::VirtualTrackingDevice::Pointer tracker = mitk::VirtualTrackingDevice::New(); <span class="comment">// create virtual tracker</span></div>
<div class="line"> </div>
<div class="line">      mitk::ScalarType bounds[] = {0.0, 200.0, 0.0, 200.0, 0.0, 200.0};</div>
<div class="line">      tracker-&gt;SetBounds(bounds);</div>
<div class="line">      tracker-&gt;AddTool(<span class="stringliteral">&quot;MyInstrument&quot;</span>);      <span class="comment">// add a tool to tracker</span></div>
<div class="line"> </div>
<div class="line">      <span class="comment">//The tracking device object is used for the physical connection to the device. To use the</span></div>
<div class="line">      <span class="comment">//data inside of our tracking pipeline we need a source. This source encapsulate the tracking device</span></div>
<div class="line">      <span class="comment">//and provides objects of the type mitk::NavigationData as output. The NavigationData objects stores</span></div>
<div class="line">      <span class="comment">//position, orientation, if the data is valid or not and special error information in a covariance</span></div>
<div class="line">      <span class="comment">//matrix.</span></div>
<div class="line">      <span class="comment">//</span></div>
<div class="line">      <span class="comment">//Typically the start of a pipeline is a TrackingDeviceSource. To work correct we have to set a</span></div>
<div class="line">      <span class="comment">//TrackingDevice object. Attention you have to set the tools before you set the whole TrackingDevice</span></div>
<div class="line">      <span class="comment">//object to the TrackingDeviceSource because the source need to know how many outputs should be</span></div>
<div class="line">      <span class="comment">//generated.</span></div>
<div class="line">      <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a> = mitk::TrackingDeviceSource::New();   <span class="comment">//We need the filter objects to stay alive,</span></div>
<div class="line">      <span class="comment">//therefore they must be members.</span></div>
<div class="line">      <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a>-&gt;SetTrackingDevice(tracker); <span class="comment">//Here we set the tracking device to the source of the pipeline.</span></div>
<div class="line"><span class="comment">      /**************** End of Variant 2 ****************/</span></div>
<div class="line">    }</div>
</div><!-- fragment --><p>Now we need to connect the tracking system</p>
<div class="fragment"><div class="line">    <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a>-&gt;Connect();                  <span class="comment">//Now we connect to the tracking system.</span></div>
<div class="line">    <span class="comment">//Note we do not call this on the TrackingDevice object</span></div>
</div><!-- fragment --><p>For the visualisation, we need an object. Here, we create a red cone</p>
<div class="fragment"><div class="line">    <span class="comment">//As we wish to visualize our tool we need to have a PolyData which shows us the movement of our tool.</span></div>
<div class="line">    <span class="comment">//Here we take a cone shaped PolyData. In MITK you have to add the PolyData as a node into the DataStorage</span></div>
<div class="line">    <span class="comment">//to show it inside of the rendering windows. After that you can change the properties of the cone</span></div>
<div class="line">    <span class="comment">//to manipulate rendering, e.g. the position and orientation as in our case.</span></div>
<div class="line">    mitk::Cone::Pointer cone = mitk::Cone::New();                 <span class="comment">//instantiate a new cone</span></div>
<div class="line">    <span class="keywordtype">double</span> scale[] = {10.0, 10.0, 10.0};</div>
<div class="line">    cone-&gt;GetGeometry()-&gt;SetSpacing(scale);                       <span class="comment">//scale it a little that so we can see something</span></div>
<div class="line">    mitk::DataNode::Pointer node = mitk::DataNode::New(); <span class="comment">//generate a new node to store the cone into</span></div>
<div class="line">    <span class="comment">//the DataStorage.</span></div>
<div class="line">    node-&gt;SetData(cone);                          <span class="comment">//The data of that node is our cone.</span></div>
<div class="line">    node-&gt;SetName(<span class="stringliteral">&quot;My tracked object&quot;</span>);           <span class="comment">//The node has additional properties like a name</span></div>
<div class="line">    node-&gt;SetColor(1.0, 0.0, 0.0);                <span class="comment">//or the color. Here we make it red.</span></div>
<div class="line">    this-&gt;GetDataStorage()-&gt;Add(node);     <span class="comment">//After adding the Node with the cone in it to the</span></div>
<div class="line">    <span class="comment">//DataStorage, MITK will show the cone in the</span></div>
<div class="line">    <span class="comment">//render windows.</span></div>
</div><!-- fragment --><p>The visualization filter will actually render the cone </p><div class="fragment"><div class="line">    <span class="comment">//For updating the render windows we use another filter of the MITK-IGT pipeline concept. The</span></div>
<div class="line">    <span class="comment">//NavigationDataObjectVisualizationFilter needs as input a NavigationData and a</span></div>
<div class="line">    <span class="comment">//PolyData. In our case the input is the source and the PolyData our cone.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//First we create a new filter for the visualization update.</span></div>
<div class="line">    <a class="code hl_variable" href="classQmitkIGTTutorialView.html#a6b7e52fe160d7603cc9772dc55da9dc8">m_Visualizer</a> = mitk::NavigationDataObjectVisualizationFilter::New();</div>
<div class="line">    <a class="code hl_variable" href="classQmitkIGTTutorialView.html#a6b7e52fe160d7603cc9772dc55da9dc8">m_Visualizer</a>-&gt;SetInput(0, <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a>-&gt;GetOutput());        <span class="comment">//Then we connect to the pipeline.</span></div>
<div class="line">    <a class="code hl_variable" href="classQmitkIGTTutorialView.html#a6b7e52fe160d7603cc9772dc55da9dc8">m_Visualizer</a>-&gt;SetRepresentationObject(0, cone.GetPointer()); <span class="comment">// After that we have to assign the cone to the input</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//Now this simple pipeline is ready, so we can start the tracking. Here again: We do not call the</span></div>
<div class="line">    <span class="comment">//StartTracking method from the tracker object itself. Instead we call this method from our source.</span></div>
<div class="line">    <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a>-&gt;StartTracking();</div>
</div><!-- fragment --><p>For a continuous display, we need to call update, here we decide to do it every 100 ms using a timer. </p><div class="fragment"><div class="line">    <span class="comment">//Now every call of m_Visualizer-&gt;Update() will show us the cone at the position and orientation</span></div>
<div class="line">    <span class="comment">//given from the tracking device.</span></div>
<div class="line">    <span class="comment">//We use a QTimer object to call this Update() method in a fixed interval.</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classQmitkIGTTutorialView.html#a127840ab14d7820fce7f67ce947f41a5">m_Timer</a> == <span class="keyword">nullptr</span>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_variable" href="classQmitkIGTTutorialView.html#a127840ab14d7820fce7f67ce947f41a5">m_Timer</a> = <span class="keyword">new</span> QTimer(<span class="keyword">this</span>);  <span class="comment">//create a new timer</span></div>
<div class="line">    }</div>
<div class="line">    connect(<a class="code hl_variable" href="classQmitkIGTTutorialView.html#a127840ab14d7820fce7f67ce947f41a5">m_Timer</a>, SIGNAL(timeout()), <span class="keyword">this</span>, SLOT(<a class="code hl_slot" href="classQmitkIGTTutorialView.html#ad855249865262226e80d27d5783489b7">OnTimer</a>())); <span class="comment">//connect the timer to the method OnTimer()</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_variable" href="classQmitkIGTTutorialView.html#a127840ab14d7820fce7f67ce947f41a5">m_Timer</a>-&gt;start(100);  <span class="comment">//Every 100ms the method OnTimer() is called. -&gt; 10fps</span></div>
</div><!-- fragment --><p>Disable the selection of tracking devices during tracking: </p><div class="fragment"><div class="line">    <span class="comment">//disable the tracking device selection</span></div>
<div class="line">    this-&gt;<a class="code hl_variable" href="classQmitkIGTTutorialView.html#a770ec28e67ccf5172376efbfc64b1cc1">m_Controls</a>-&gt;m_NDITrackingRadioButton-&gt;setDisabled(<span class="keyword">true</span>);</div>
<div class="line">    this-&gt;<a class="code hl_variable" href="classQmitkIGTTutorialView.html#a770ec28e67ccf5172376efbfc64b1cc1">m_Controls</a>-&gt;m_virtualTrackingRadioButton-&gt;setDisabled(<span class="keyword">true</span>);</div>
</div><!-- fragment --><p>For proper coding, you should always catch the exceptions: </p><div class="fragment"><div class="line">  <span class="keywordflow">catch</span> (std::exception&amp; e)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// add cleanup</span></div>
<div class="line">    MITK_INFO &lt;&lt; <span class="stringliteral">&quot;Error in QmitkIGTTutorial::OnStartIGT():&quot;</span> &lt;&lt; e.what();</div>
<div class="line">  }</div>
</div><!-- fragment --><h1><a class="anchor" id="OnTimer"></a>
OnTimer</h1>
<p>Each time, the timer is updated, the following code is executed: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_slot" href="classQmitkIGTTutorialView.html#ad855249865262226e80d27d5783489b7">QmitkIGTTutorialView::OnTimer</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">//Here we call the Update() method from the Visualization Filter. Internally the filter checks if</span></div>
<div class="line">  <span class="comment">//new NavigationData is available. If we have a new NavigationData the cone position and orientation</span></div>
<div class="line">  <span class="comment">//will be adapted.</span></div>
<div class="line">  <a class="code hl_variable" href="classQmitkIGTTutorialView.html#a6b7e52fe160d7603cc9772dc55da9dc8">m_Visualizer</a>-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> geo = this-&gt;GetDataStorage()-&gt;ComputeBoundingGeometry3D(this-&gt;GetDataStorage()-&gt;GetAll());</div>
<div class="line">  mitk::RenderingManager::GetInstance()-&gt;InitializeViews( geo );</div>
<div class="line">  this-&gt;RequestRenderWindowUpdate();</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="OnStopIGT"></a>
OnStopIGT</h1>
<p>This function will stop the pipeline and clean up everything: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_slot" href="classQmitkIGTTutorialView.html#a1ba15f8f8f7e3cd06a618d9fe526a6c0">QmitkIGTTutorialView::OnStopIGT</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">//This method is called when the Stop button is pressed. Here we disconnect the pipeline.</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classQmitkIGTTutorialView.html#a127840ab14d7820fce7f67ce947f41a5">m_Timer</a> == <span class="keyword">nullptr</span>)</div>
<div class="line">  {</div>
<div class="line">    MITK_INFO &lt;&lt; <span class="stringliteral">&quot;No Timer was set yet!&quot;</span>;</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">//To disconnect the pipeline in a save way we first stop the timer than we disconnect the tracking device.</span></div>
<div class="line">  <span class="comment">//After that we destroy all filters with changing them to nullptr.</span></div>
<div class="line">  <a class="code hl_variable" href="classQmitkIGTTutorialView.html#a127840ab14d7820fce7f67ce947f41a5">m_Timer</a>-&gt;stop();</div>
<div class="line">  disconnect(<a class="code hl_variable" href="classQmitkIGTTutorialView.html#a127840ab14d7820fce7f67ce947f41a5">m_Timer</a>, SIGNAL(timeout()), <span class="keyword">this</span>, SLOT(<a class="code hl_slot" href="classQmitkIGTTutorialView.html#ad855249865262226e80d27d5783489b7">OnTimer</a>()));</div>
<div class="line">  <a class="code hl_variable" href="classQmitkIGTTutorialView.html#a127840ab14d7820fce7f67ce947f41a5">m_Timer</a> = <span class="keyword">nullptr</span>;</div>
<div class="line">  <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a>-&gt;StopTracking();</div>
<div class="line">  <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a>-&gt;Disconnect();</div>
<div class="line">  <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a> = <span class="keyword">nullptr</span>;</div>
<div class="line">  <a class="code hl_variable" href="classQmitkIGTTutorialView.html#a6b7e52fe160d7603cc9772dc55da9dc8">m_Visualizer</a> = <span class="keyword">nullptr</span>;</div>
<div class="line">  <a class="code hl_variable" href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">m_Source</a> = <span class="keyword">nullptr</span>;</div>
<div class="line">  this-&gt;GetDataStorage()-&gt;Remove(this-&gt;GetDataStorage()-&gt;GetNamedNode(<span class="stringliteral">&quot;My tracked object&quot;</span>));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//enable the tracking device selection</span></div>
<div class="line">  this-&gt;<a class="code hl_variable" href="classQmitkIGTTutorialView.html#a770ec28e67ccf5172376efbfc64b1cc1">m_Controls</a>-&gt;m_NDITrackingRadioButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line">  this-&gt;<a class="code hl_variable" href="classQmitkIGTTutorialView.html#a770ec28e67ccf5172376efbfc64b1cc1">m_Controls</a>-&gt;m_virtualTrackingRadioButton-&gt;setEnabled(<span class="keyword">true</span>);</div>
<div class="line">}</div>
<div class="ttc" id="aQmitkIGTTutorialView_8h_html"><div class="ttname"><a href="QmitkIGTTutorialView_8h.html">QmitkIGTTutorialView.h</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_a01729a28c0949e147d275b4282bf7cf5"><div class="ttname"><a href="classQmitkIGTTutorialView.html#a01729a28c0949e147d275b4282bf7cf5">QmitkIGTTutorialView::~QmitkIGTTutorialView</a></div><div class="ttdeci">~QmitkIGTTutorialView() override</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8cpp_source.html#l00037">QmitkIGTTutorialView.cpp:37</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_a03f290f389daeb3df9470d7b432bfe4b"><div class="ttname"><a href="classQmitkIGTTutorialView.html#a03f290f389daeb3df9470d7b432bfe4b">QmitkIGTTutorialView::CreateConnections</a></div><div class="ttdeci">virtual void CreateConnections()</div><div class="ttdoc">Creation of the connections of main and control widget.</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8cpp_source.html#l00055">QmitkIGTTutorialView.cpp:55</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_a109a853ea52354981af4c31bb2d21d66"><div class="ttname"><a href="classQmitkIGTTutorialView.html#a109a853ea52354981af4c31bb2d21d66">QmitkIGTTutorialView::VIEW_ID</a></div><div class="ttdeci">static const std::string VIEW_ID</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8h_source.html#l00044">QmitkIGTTutorialView.h:44</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_a127840ab14d7820fce7f67ce947f41a5"><div class="ttname"><a href="classQmitkIGTTutorialView.html#a127840ab14d7820fce7f67ce947f41a5">QmitkIGTTutorialView::m_Timer</a></div><div class="ttdeci">QTimer * m_Timer</div><div class="ttdoc">timer for continuous tracking update</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8h_source.html#l00079">QmitkIGTTutorialView.h:79</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_a1ba15f8f8f7e3cd06a618d9fe526a6c0"><div class="ttname"><a href="classQmitkIGTTutorialView.html#a1ba15f8f8f7e3cd06a618d9fe526a6c0">QmitkIGTTutorialView::OnStopIGT</a></div><div class="ttdeci">void OnStopIGT()</div><div class="ttdoc">stop IGT scene and clean up</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8cpp_source.html#l00233">QmitkIGTTutorialView.cpp:233</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_a4fa682b14bfb46190e5e49b4534a2f63"><div class="ttname"><a href="classQmitkIGTTutorialView.html#a4fa682b14bfb46190e5e49b4534a2f63">QmitkIGTTutorialView::OnStartIGT</a></div><div class="ttdeci">void OnStartIGT()</div><div class="ttdoc">Execute MITK-IGT Tutorial.</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8cpp_source.html#l00071">QmitkIGTTutorialView.cpp:71</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_a6b7e52fe160d7603cc9772dc55da9dc8"><div class="ttname"><a href="classQmitkIGTTutorialView.html#a6b7e52fe160d7603cc9772dc55da9dc8">QmitkIGTTutorialView::m_Visualizer</a></div><div class="ttdeci">mitk::NavigationDataObjectVisualizationFilter::Pointer m_Visualizer</div><div class="ttdoc">visualization filter uses output from m_Source</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8h_source.html#l00078">QmitkIGTTutorialView.h:78</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_a770ec28e67ccf5172376efbfc64b1cc1"><div class="ttname"><a href="classQmitkIGTTutorialView.html#a770ec28e67ccf5172376efbfc64b1cc1">QmitkIGTTutorialView::m_Controls</a></div><div class="ttdeci">Ui::QmitkIGTTutorialViewControls * m_Controls</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8h_source.html#l00075">QmitkIGTTutorialView.h:75</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_a809dd49cc6fc0de6160987cadda822f7"><div class="ttname"><a href="classQmitkIGTTutorialView.html#a809dd49cc6fc0de6160987cadda822f7">QmitkIGTTutorialView::CreateQtPartControl</a></div><div class="ttdeci">void CreateQtPartControl(QWidget *parent) override</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8cpp_source.html#l00042">QmitkIGTTutorialView.cpp:42</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_ad855249865262226e80d27d5783489b7"><div class="ttname"><a href="classQmitkIGTTutorialView.html#ad855249865262226e80d27d5783489b7">QmitkIGTTutorialView::OnTimer</a></div><div class="ttdeci">void OnTimer()</div><div class="ttdoc">timer based update of IGT scene</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8cpp_source.html#l00219">QmitkIGTTutorialView.cpp:219</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_adb0dd305ad0f6c1cc4f51862fe13cda2"><div class="ttname"><a href="classQmitkIGTTutorialView.html#adb0dd305ad0f6c1cc4f51862fe13cda2">QmitkIGTTutorialView::SetFocus</a></div><div class="ttdeci">void SetFocus() override</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8cpp_source.html#l00064">QmitkIGTTutorialView.cpp:64</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_ae393c307145a68f5aa1d274b7be3c468"><div class="ttname"><a href="classQmitkIGTTutorialView.html#ae393c307145a68f5aa1d274b7be3c468">QmitkIGTTutorialView::m_Source</a></div><div class="ttdeci">mitk::TrackingDeviceSource::Pointer m_Source</div><div class="ttdoc">source filer that connects to the tracking device</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8h_source.html#l00077">QmitkIGTTutorialView.h:77</a></div></div>
<div class="ttc" id="aclassQmitkIGTTutorialView_html_aec23761173aa21d6a20b02c0ce3b07be"><div class="ttname"><a href="classQmitkIGTTutorialView.html#aec23761173aa21d6a20b02c0ce3b07be">QmitkIGTTutorialView::QmitkIGTTutorialView</a></div><div class="ttdeci">QmitkIGTTutorialView()</div><div class="ttdef"><b>Definition</b> <a href="QmitkIGTTutorialView_8cpp_source.html#l00030">QmitkIGTTutorialView.cpp:30</a></div></div>
<div class="ttc" id="aclassmitk_1_1NDIPolarisTypeInformation_html_ab1040a09938daa967f70b181398376cb"><div class="ttname"><a href="classmitk_1_1NDIPolarisTypeInformation.html#ab1040a09938daa967f70b181398376cb">mitk::NDIPolarisTypeInformation::GetTrackingDeviceName</a></div><div class="ttdeci">static std::string GetTrackingDeviceName()</div><div class="ttdef"><b>Definition</b> <a href="mitkNDIPolarisTypeInformation_8cpp_source.html#l00019">mitkNDIPolarisTypeInformation.cpp:19</a></div></div>
<div class="ttc" id="aclassmitk_1_1SerialCommunication_html_a1d5c336d9651a87cd9a24de245da75cdae13973fa7f4f4b357c0618ddc7c068ba"><div class="ttname"><a href="classmitk_1_1SerialCommunication.html#a1d5c336d9651a87cd9a24de245da75cdae13973fa7f4f4b357c0618ddc7c068ba">mitk::SerialCommunication::BaudRate115200</a></div><div class="ttdeci">@ BaudRate115200</div><div class="ttdef"><b>Definition</b> <a href="mitkSerialCommunication_8h_source.html#l00074">mitkSerialCommunication.h:74</a></div></div>
<div class="ttc" id="aclassmitk_1_1SerialCommunication_html_a8b5ad106301af6cc4247826309b2a785a334f5ba616270259a952e53679ecd173"><div class="ttname"><a href="classmitk_1_1SerialCommunication.html#a8b5ad106301af6cc4247826309b2a785a334f5ba616270259a952e53679ecd173">mitk::SerialCommunication::COM4</a></div><div class="ttdeci">@ COM4</div><div class="ttdef"><b>Definition</b> <a href="mitkSerialCommunication_8h_source.html#l00055">mitkSerialCommunication.h:55</a></div></div>
<div class="ttc" id="amitkNDIPassiveTool_8h_html"><div class="ttname"><a href="mitkNDIPassiveTool_8h.html">mitkNDIPassiveTool.h</a></div></div>
<div class="ttc" id="amitkNDIPolarisTypeInformation_8h_html"><div class="ttname"><a href="mitkNDIPolarisTypeInformation_8h.html">mitkNDIPolarisTypeInformation.h</a></div></div>
<div class="ttc" id="amitkNDITrackingDevice_8h_html"><div class="ttname"><a href="mitkNDITrackingDevice_8h.html">mitkNDITrackingDevice.h</a></div></div>
<div class="ttc" id="amitkSerialCommunication_8h_html"><div class="ttname"><a href="mitkSerialCommunication_8h.html">mitkSerialCommunication.h</a></div></div>
</div><!-- fragment --><p>You now have a very simple plugin, which creates an own tracking device and starts or stops tracking. Of course, for your more advanced project, you could implement a new tracking device to be available in every plugin (see <a class="el" href="IGTHowToImplementATrackingDevice.html">How To Implement A Tracking Device</a> ) or use already implemented tracking devices via the tracking toolbox and/or microservices. This small example should just show you the most simple way to start tracking.</p>
<p>Return to the <a class="el" href="IGTTutorialOverview.html">[IGT Tutorial Overview]</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="mitkigt.html">MITK-IGT</a></li><li class="navelem"><a class="el" href="org_mitk_gui_qt_igtexample.html">The IGT Examples</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
